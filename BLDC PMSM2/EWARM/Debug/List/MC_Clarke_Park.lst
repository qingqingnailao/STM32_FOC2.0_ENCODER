###############################################################################
#                                                                             #
# IAR ANSI C/C++ Compiler V6.40.1.53790/W32 for ARM     24/Feb/2014  19:26:34 #
# Copyright 1999-2012 IAR Systems AB.                                         #
#                                                                             #
#    Cpu mode     =  thumb                                                    #
#    Endian       =  little                                                   #
#    Source file  =  D:\stm32\BLDC PMSM2\src\MC_Clarke_Park.c                 #
#    Command line =  "D:\stm32\BLDC PMSM2\src\MC_Clarke_Park.c" -D            #
#                    VECT_TAB_FLASH -lCN "D:\stm32\BLDC                       #
#                    PMSM2\EWARM\Debug\List\" --diag_error Pe068,Pe069 -o     #
#                    "D:\stm32\BLDC PMSM2\EWARM\Debug\Obj\" --debug           #
#                    --endian=little --cpu=Cortex-M3 --fpu=None               #
#                    --dlib_config "C:\Program Files\IAR Systems\Embedded     #
#                    Workbench 6.4\arm\INC\c\DLib_Config_Normal.h" -I         #
#                    "D:\stm32\BLDC PMSM2\EWARM\..\" -I "D:\stm32\BLDC        #
#                    PMSM2\EWARM\..\..\STM32F10XFWLIB\inc\" -I                #
#                    "D:\stm32\BLDC PMSM2\EWARM\..\inc\" -Ohs                 #
#                    --use_c++_inline --require_prototypes                    #
#    List file    =  D:\stm32\BLDC PMSM2\EWARM\Debug\List\MC_Clarke_Park.lst  #
#    Object file  =  D:\stm32\BLDC PMSM2\EWARM\Debug\Obj\MC_Clarke_Park.o     #
#                                                                             #
#                                                                             #
###############################################################################

D:\stm32\BLDC PMSM2\src\MC_Clarke_Park.c
      1          /******************** (C) COPYRIGHT 2008 STMicroelectronics ********************
      2          * File Name          : MC_Clarke_Park.c 
      3          * Author             : IMS Systems Lab  
      4          * Date First Issued  : 21/11/07
      5          * Description        : This module implements the reference frame transformations
      6          *                      needed for vector control: Clarke, Park and Reverse Park.
      7          *                      It also performs the voltage circle limitation.
      8          ********************************************************************************
      9          * History:
     10          * 21/11/07 v1.0
     11          * 29/05/08 v2.0
     12          * 14/07/08 v2.0.1
     13          ********************************************************************************
     14          * THE PRESENT SOFTWARE WHICH IS FOR GUIDANCE ONLY AIMS AT PROVIDING CUSTOMERS
     15          * WITH CODING INFORMATION REGARDING THEIR PRODUCTS IN ORDER FOR THEM TO SAVE TIME.
     16          * AS A RESULT, STMICROELECTRONICS SHALL NOT BE HELD LIABLE FOR ANY DIRECT,
     17          * INDIRECT OR CONSEQUENTIAL DAMAGES WITH RESPECT TO ANY CLAIMS ARISING FROM THE
     18          * CONTENT OF SUCH SOFTWARE AND/OR THE USE MADE BY CUSTOMERS OF THE CODING
     19          * INFORMATION CONTAINED HEREIN IN CONNECTION WITH THEIR PRODUCTS.
     20          *
     21          * THIS SOURCE CODE IS PROTECTED BY A LICENSE.
     22          * FOR MORE INFORMATION PLEASE CAREFULLY READ THE LICENSE AGREEMENT FILE LOCATED
     23          * IN THE ROOT DIRECTORY OF THIS FIRMWARE PACKAGE.
     24          *******************************************************************************/
     25          /* Includes ------------------------------------------------------------------*/
     26          #include "MC_Control_Param.h"
     27          #include "MC_Clarke_Park.h"
     28          #include "MC_const.h" 
     29          #include "MC_Globals.h"
     30          
     31          /* Private typedef -----------------------------------------------------------*/
     32          /* Private define ------------------------------------------------------------*/
     33          #ifdef MAX_MODULATION_77_PER_CENT
     34          #define START_INDEX     37
     35          
     36          static const u16 circle_limit_table[91]=     
     37          {
     38           32468,32176,31893,31347,31084,30578,30334,29863,29636,29414,28984,28776,28373,
     39           28178,27987,27616,27436,27086,26916,26585,26425,26267,25959,25809,25518,25375,
     40           25098,24962,24829,24569,24442,24194,24072,23953,23719,23604,23381,23271,23056,
     41           22951,22848,22644,22545,22349,22254,22066,21974,21883,21704,21616,21444,21359,
     42           21275,21111,21030,20872,20793,20640,20564,20490,20343,20270,20128,20058,19920,
     43           19852,19785,19653,19587,19459,19396,19271,19209,19148,19028,18969,18852,18795,
     44           18738,18625,18570,18460,18406,18299,18246,18194,18091,18040,17940,17890,17792
     45          };
     46          #endif
     47          
     48          
     49          #ifdef MAX_MODULATION_79_PER_CENT
     50          #define START_INDEX     39
     51          
     52          static const u16 circle_limit_table[89]=     
     53          {
     54          32489,32217,31952,31442,31195,30719,30489,30045,29830,29413,29211,28819,28629,
     55          28442,28080,27904,27562,27396,27072,26914,26607,26457,26165,26022,25882,25608,
     56          25475,25214,25086,24836,24715,24476,24359,24130,24019,23908,23692,23586,23378,
     57          23276,23077,22979,22787,22692,22507,22416,22326,22150,22063,21893,21809,21645,
     58          21564,21405,21327,21173,21097,21022,20875,20802,20659,20589,20450,20382,20247,
     59          20181,20051,19986,19923,19797,19735,19613,19553,19434,19375,19260,19202,19090,
     60          19034,18979,18871,18817,18711,18659,18555,18504,18403,18354,18255
     61          };
     62          #endif
     63          
     64          #ifdef MAX_MODULATION_81_PER_CENT
     65          #define START_INDEX     41
     66          
     67          static const u16 circle_limit_table[87]=     
     68          {
     69          32508,32255,32008,31530,31299,30852,30636,30216,30012,29617,29426,29053,28872,
     70          28520,28349,28015,27853,27536,27382,27081,26934,26647,26507,26234,26101,25840,
     71          25712,25462,25340,25101,24984,24755,24643,24422,24315,24103,24000,23796,23696,
     72          23500,23404,23216,23123,22941,22851,22763,22589,22504,22336,22253,22091,22011,
     73          21854,21776,21624,21549,21401,21329,21186,21115,20976,20908,20773,20706,20575,
     74          20511,20383,20320,20196,20135,20015,19955,19838,19780,19666,19609,19498,19443,
     75          19334,19280,19175,19122,19019,18968,18867,18817,18719
     76          };
     77          #endif
     78          
     79          #ifdef MAX_MODULATION_83_PER_CENT
     80          #define START_INDEX     44
     81          
     82          static const u16 circle_limit_table[84]=     
     83          {
     84          32291,32060,31613,31397,30977,30573,30377,29996,29811,29451,29276,28934,28768,
     85          28444,28286,27978,27827,27533,27390,27110,26973,26705,26574,26318,26069,25948,
     86          25709,25592,25363,25251,25031,24923,24711,24607,24404,24304,24107,24011,23821,
     87          23728,23545,23456,23279,23192,23021,22854,22772,22610,22530,22374,22297,22145,
     88          22070,21922,21850,21707,21636,21497,21429,21294,21227,21096,21032,20904,20778,
     89          20717,20595,20534,20416,20357,20241,20184,20071,20015,19905,19851,19743,19690,
     90          19585,19533,19431,19380,19280,19182
     91          };
     92          #endif
     93          
     94          
     95          #ifdef MAX_MODULATION_85_PER_CENT
     96          #define START_INDEX     46
     97          
     98          static const u16 circle_limit_table[82]=     
     99          {
    100          32324,32109,31691,31489,31094,30715,30530,30170,29995,29654,29488,29163,29005,
    101          28696,28397,28250,27965,27825,27552,27418,27157,26903,26779,26535,26416,26182,
    102          26067,25842,25623,25515,25304,25201,24997,24897,24701,24605,24415,24230,24139,
    103          23960,23872,23699,23614,23446,23282,23201,23042,22964,22810,22734,22584,22437,
    104          22365,22223,22152,22014,21945,21811,21678,21613,21484,21421,21296,21234,21112,
    105          21051,20932,20815,20757,20643,20587,20476,20421,20312,20205,20152,20048,19996
    106          ,19894,19844,19744,19645
    107          };
    108          #endif
    109          
    110          
    111          
    112          #ifdef MAX_MODULATION_87_PER_CENT
    113          #define START_INDEX     48
    114          
    115          static const u16 circle_limit_table[81]=     
    116          {
    117          32559,32154,31764,31575,31205,31025,30674,30335,30170,29847,
    118          29689,29381,29083,28937,28652,28375,28239,27974,27844,27589,
    119          27342,27220,26983,26866,26637,26414,26305,26090,25984,25777,
    120          25575,25476,25280,25184,24996,24811,24720,24542,24367,24281,
    121          24112,24028,23864,23703,23624,23468,23391,23240,23091,23018,
    122          22874,22803,22662,22524,22456,22322,22191,22126,21997,21934,
    123          21809,21686,21625,21505,21446,21329,21214,21157,21045,20990,
    124          20880,20772,20719,20613,20561,20458,20356,20306,20207,20158,
    125          20109
    126          };
    127          #endif
    128          
    129          #ifdef MAX_MODULATION_89_PER_CENT
    130          #define START_INDEX     50
    131          
    132          static const u16 circle_limit_table[78]=     
    133          {
    134          32574,32197,32014,31656,31309,31141,30811,30491,30335,30030,
    135          29734,29589,29306,29031,28896,28632,28375,28249,28002,27881,
    136          27644,27412,27299,27076,26858,26751,26541,26336,26235,26037,
    137          25844,25748,25561,25378,25288,25110,24936,24851,24682,24517,
    138          24435,24275,24118,24041,23888,23738,23664,23518,23447,23305,
    139          23166,23097,22962,22828,22763,22633,22505,22442,22318,22196,
    140          22135,22016,21898,21840,21726,21613,21557,21447,21338,21284,
    141          21178,21074,21022,20919,20819,20769,20670,20573
    142          };
    143          #endif
    144          
    145          #ifdef MAX_MODULATION_91_PER_CENT
    146          #define START_INDEX     52
    147          
    148          static const u16 circle_limit_table[76]=     
    149          {
    150          32588,32411,32066,31732,31569,31250,30940,30789,30492,30205,
    151          29925,29788,29519,29258,29130,28879,28634,28395,28278,28048,
    152          27823,27713,27497,27285,27181,26977,26777,26581,26485,26296,
    153          26110,26019,25840,25664,25492,25407,25239,25076,24995,24835,
    154          24679,24602,24450,24301,24155,24082,23940,23800,23731,23594,
    155          23460,23328,23263,23135,23008,22946,22822,22701,22641,22522,
    156          22406,22291,22234,22122,22011,21956,21848,21741,21636,21584,
    157          21482,21380,21330,21231,21133,21037
    158          };
    159          #endif
    160          
    161          
    162          #ifdef MAX_MODULATION_92_PER_CENT
    163          #define START_INDEX     54
    164          
    165          const u16 circle_limit_table[74]=     
    166          {
    167          32424,32091,31929,31611,31302,31002,30855,30568,30289,30017,
    168          29884,29622,29368,29243,28998,28759,28526,28412,28187,27968,
    169          27753,27648,27441,27238,27040,26942,26750,26563,26470,26288,
    170          26110,25935,25849,25679,25513,25350,25269,25111,24955,24803,
    171          24727,24579,24433,24361,24219,24079,23942,23874,23740,23609,
    172          23479,23415,23289,23165,23042,22982,22863,22745,22629,22572,
    173          22459,22347,22292,22183,22075,21970,21917,21813,21711,21610,
    174          21561,21462,21365,21268
    175          };
    176          #endif
    177          
    178          
    179          #ifdef MAX_MODULATION_93_PER_CENT
    180          #define START_INDEX     55
    181          
    182          const u16 circle_limit_table[73]=     
    183          {
    184          32437,32275,31959,31651,31353,31207,30920,30642,30371,30107,
    185          29977,29723,29476,29234,29116,28883,28655,28433,28324,28110,
    186          27900,27695,27594,27395,27201,27011,26917,26733,26552,26375,
    187          26202,26116,25948,25783,25621,25541,25383,25228,25076,25001,
    188          24854,24708,24565,24495,24356,24219,24084,24018,23887,23758,
    189          23631,23506,23444,23322,23202,23083,23025,22909,22795,22683,
    190          22627,22517,22409,22302,22250,22145,22042,21941,21890,21791,
    191          21693,21596,21500
    192          };
    193          #endif
    194          
    195          
    196          #ifdef MAX_MODULATION_94_PER_CENT
    197          #define START_INDEX     56
    198          
    199          const u16 circle_limit_table[72]=     
    200          {
    201          32607,32293,31988,31691,31546,31261,30984,30714,30451,30322,
    202          30069,29822,29581,29346,29231,29004,28782,28565,28353,28249,
    203          28044,27843,27647,27455,27360,27174,26991,26812,26724,26550,
    204          26380,26213,26049,25968,25808,25652,25498,25347,25272,25125,
    205          24981,24839,24699,24630,24494,24360,24228,24098,24034,23908,
    206          23783,23660,23600,23480,23361,23245,23131,23074,22962,22851,
    207          22742,22635,22582,22477,22373,22271,22170,22120,22021,21924,
    208          21827,21732
    209          };
    210          #endif
    211          
    212          
    213          #ifdef MAX_MODULATION_95_PER_CENT
    214          #define START_INDEX     57
    215          
    216          const u16 circle_limit_table[71]=     
    217          {
    218          32613,32310,32016,31872,31589,31314,31046,30784,30529,30404,
    219          30158,29919,29684,29456,29343,29122,28906,28695,28488,28285,
    220          28186,27990,27798,27610,27425,27245,27155,26980,26808,26639,
    221          26473,26392,26230,26072,25917,25764,25614,25540,25394,25250,
    222          25109,24970,24901,24766,24633,24501,24372,24245,24182,24058,
    223          23936,23816,23697,23580,23522,23408,23295,23184,23075,23021,
    224          22913,22808,22703,22600,22499,22449,22349,22251,22154,22059,
    225          21964
    226          };
    227          #endif
    228          
    229          
    230          #ifdef MAX_MODULATION_96_PER_CENT
    231          #define START_INDEX     58
    232          
    233          const u16 circle_limit_table[70]=     
    234          {
    235          32619,32472,32184,31904,31631,31365,31106,30853,30728,30484,
    236          30246,30013,29785,29563,29345,29238,29028,28822,28620,28423,
    237          28229,28134,27946,27762,27582,27405,27231,27061,26977,26811,
    238          26649,26489,26332,26178,26027,25952,25804,25659,25517,25376,
    239          25238,25103,25035,24903,24772,24644,24518,24393,24270,24210,
    240          24090,23972,23855,23741,23627,23516,23461,23352,23244,23138,
    241          23033,22930,22828,22777,22677,22579,22481,22385,22290,22196
    242          };
    243          #endif
    244          
    245          
    246          #ifdef MAX_MODULATION_97_PER_CENT
    247          #define START_INDEX     60
    248          
    249          const u16 circle_limit_table[68]=     
    250          {
    251          32483,32206,31936,31672,31415,31289,31041,30799,30563,30331,
    252          30105,29884,29668,29456,29352,29147,28947,28750,28557,28369,
    253          28183,28002,27824,27736,27563,27393,27226,27062,26901,26743,
    254          26588,26435,26360,26211,26065,25921,25780,25641,25504,25369,
    255          25236,25171,25041,24913,24788,24664,24542,24422,24303,24186,
    256          24129,24015,23902,23791,23681,23573,23467,23362,23258,23206,
    257          23105,23004,22905,22808,22711,22616,22521,22429
    258          };
    259          #endif
    260          
    261          
    262          #ifdef MAX_MODULATION_98_PER_CENT
    263          #define START_INDEX     61
    264          

   \                                 In section .text, align 4, keep-with-next
    265          const u16 circle_limit_table[67]=     
   \                     circle_limit_table:
   \   00000000   0x7EEE 0x7E68      DC16 32494, 32360, 32096, 31839, 31587, 31342, 31102, 30868, 30639
   \              0x7D60 0x7C5F
   \              0x7B63 0x7A6E
   \              0x797E 0x7894
   \              0x77AF       
   \   00000012   0x76CF 0x75F4      DC16 30415, 30196, 29981, 29771, 29565, 29464, 29265, 29069, 28878
   \              0x751D 0x744B
   \              0x737D 0x7318
   \              0x7251 0x718D
   \              0x70CE       
   \   00000024   0x7012 0x6F5A      DC16 28690, 28506, 28325, 28148, 27974, 27803, 27635, 27470, 27309
   \              0x6EA5 0x6DF4
   \              0x6D46 0x6C9B
   \              0x6BF3 0x6B4E
   \              0x6AAD       
   \   00000036   0x6A5D 0x69BF      DC16 27229, 27071, 26916, 26764, 26614, 26467, 26322, 26180, 26039
   \              0x6924 0x688C
   \              0x67F6 0x6763
   \              0x66D2 0x6644
   \              0x65B7       
   \   00000048   0x652D 0x64A6      DC16 25901, 25766, 25632, 25500, 25435, 25307, 25180, 25055, 24932
   \              0x6420 0x639C
   \              0x635B 0x62DB
   \              0x625C 0x61DF
   \              0x6164       
   \   0000005A   0x60EB 0x6074      DC16 24811, 24692, 24574, 24458, 24343, 24230, 24119, 24009, 23901
   \              0x5FFE 0x5F8A
   \              0x5F17 0x5EA6
   \              0x5E37 0x5DC9
   \              0x5D5D       
   \   0000006C   0x5D28 0x5CBD      DC16 23848, 23741, 23637, 23533, 23431, 23331, 23231, 23133, 23036
   \              0x5C55 0x5BED
   \              0x5B87 0x5B23
   \              0x5ABF 0x5A5D
   \              0x59FC       
   \   0000007E   0x599D 0x593E      DC16 22941, 22846, 22753, 22661
   \              0x58E1 0x5885
   \   00000086   0x00 0x00          DC8 0, 0
    266          {
    267          32494,32360,32096,31839,31587,31342,31102,30868,30639,30415,
    268          30196,29981,29771,29565,29464,29265,29069,28878,28690,28506,
    269          28325,28148,27974,27803,27635,27470,27309,27229,27071,26916,
    270          26764,26614,26467,26322,26180,26039,25901,25766,25632,25500,
    271          25435,25307,25180,25055,24932,24811,24692,24574,24458,24343,
    272          24230,24119,24009,23901,23848,23741,23637,23533,23431,23331,
    273          23231,23133,23036,22941,22846,22753,22661
    274          };
    275          #endif
    276          
    277          
    278          #ifdef MAX_MODULATION_99_PER_CENT
    279          #define START_INDEX     62
    280          
    281          const u16 circle_limit_table[66]=     
    282          {
    283          32635,32375,32121,31873,31631,31394,31162,30935,30714,30497,
    284          30284,30076,29872,29672,29574,29380,29190,29003,28820,28641,
    285          28464,28291,28122,27955,27791,27630,27471,27316,27163,27012,
    286          26864,26718,26575,26434,26295,26159,26024,25892,25761,25633,
    287          25569,25444,25320,25198,25078,24959,24842,24727,24613,24501,
    288          24391,24281,24174,24067,23963,23859,23757,23656,23556,23458,
    289          23361,23265,23170,23077,22984,22893
    290          };
    291          #endif
    292          
    293          
    294          #ifdef MAX_MODULATION_100_PER_CENT
    295          #define START_INDEX     63
    296          
    297          const u16 circle_limit_table[65]=     
    298          {
    299          32767,32390,32146,31907,31673,31444,31220,31001,30787,30577,30371,
    300          30169,29971,29777,29587,29400,29217,29037,28861,28687,28517,
    301          28350,28185,28024,27865,27709,27555,27404,27256,27110,26966,
    302          26824,26685,26548,26413,26280,26149,26019,25892,25767,25643,
    303          25521,25401,25283,25166,25051,24937,24825,24715,24606,24498,
    304          24392,24287,24183,24081,23980,23880,23782,23684,23588,23493,
    305          23400,23307,23215,23125
    306          };
    307          #endif
    308          
    309          #define SIN_MASK 0x0300
    310          #define U0_90     0x0200
    311          #define U90_180   0x0300
    312          #define U180_270  0x0000
    313          #define U270_360  0x0100
    314          
    315          /* Private macro -------------------------------------------------------------*/
    316          /* Private variables ---------------------------------------------------------*/
    317          

   \                                 In section .bss, align 4
    318          static Trig_Components Vector_Components;
   \                     Vector_Components:
   \   00000000                      DS8 4

   \                                 In section .text, align 4, keep-with-next
    319          const s16 hSin_Cos_Table[256] = SIN_COS_TABLE;
   \                     hSin_Cos_Table:
   \   00000000   0x0000 0x00C9      DC16 0, 201, 402, 603, 804, 1005, 1206, 1407, 1608, 1809, 2009, 2210
   \              0x0192 0x025B
   \              0x0324 0x03ED
   \              0x04B6 0x057F
   \              0x0648 0x0711
   \              0x07D9 0x08A2
   \   00000018   0x096A 0x0A33      DC16 2410, 2611, 2811, 3012, 3212, 3412, 3612, 3811, 4011, 4210, 4410
   \              0x0AFB 0x0BC4
   \              0x0C8C 0x0D54
   \              0x0E1C 0x0EE3
   \              0x0FAB 0x1072
   \              0x113A       
   \   0000002E   0x1201 0x12C8      DC16 4609, 4808, 5007, 5205, 5404, 5602, 5800, 5998, 6195, 6393, 6590
   \              0x138F 0x1455
   \              0x151C 0x15E2
   \              0x16A8 0x176E
   \              0x1833 0x18F9
   \              0x19BE       
   \   00000044   0x1A82 0x1B47      DC16 6786, 6983, 7179, 7375, 7571, 7767, 7962, 8157, 8351, 8545, 8739
   \              0x1C0B 0x1CCF
   \              0x1D93 0x1E57
   \              0x1F1A 0x1FDD
   \              0x209F 0x2161
   \              0x2223       
   \   0000005A   0x22E5 0x23A6      DC16 8933, 9126, 9319, 9512, 9704, 9896, 10087, 10278, 10469, 10659
   \              0x2467 0x2528
   \              0x25E8 0x26A8
   \              0x2767 0x2826
   \              0x28E5 0x29A3
   \   0000006E   0x2A61 0x2B1F      DC16 10849, 11039, 11228, 11417, 11605, 11793, 11980, 12167, 12353
   \              0x2BDC 0x2C99
   \              0x2D55 0x2E11
   \              0x2ECC 0x2F87
   \              0x3041       
   \   00000080   0x30FB 0x31B5      DC16 12539, 12725, 12910, 13094, 13279, 13462, 13645, 13828, 14010
   \              0x326E 0x3326
   \              0x33DF 0x3496
   \              0x354D 0x3604
   \              0x36BA       
   \   00000092   0x376F 0x3824      DC16 14191, 14372, 14553, 14732, 14912, 15090, 15269, 15446, 15623
   \              0x38D9 0x398C
   \              0x3A40 0x3AF2
   \              0x3BA5 0x3C56
   \              0x3D07       
   \   000000A4   0x3DB8 0x3E68      DC16 15800, 15976, 16151, 16325, 16499, 16673, 16846, 17018, 17189
   \              0x3F17 0x3FC5
   \              0x4073 0x4121
   \              0x41CE 0x427A
   \              0x4325       
   \   000000B6   0x43D0 0x447A      DC16 17360, 17530, 17700, 17869, 18037, 18204, 18371, 18537, 18703
   \              0x4524 0x45CD
   \              0x4675 0x471C
   \              0x47C3 0x4869
   \              0x490F       
   \   000000C8   0x49B4 0x4A58      DC16 18868, 19032, 19195, 19357, 19519, 19680, 19841, 20000, 20159
   \              0x4AFB 0x4B9D
   \              0x4C3F 0x4CE0
   \              0x4D81 0x4E20
   \              0x4EBF       
   \   000000DA   0x4F5D 0x4FFB      DC16 20317, 20475, 20631, 20787, 20942, 21096, 21250, 21403, 21554
   \              0x5097 0x5133
   \              0x51CE 0x5268
   \              0x5302 0x539B
   \              0x5432       
   \   000000EC   0x54C9 0x5560      DC16 21705, 21856, 22005, 22154, 22301, 22448, 22594, 22739, 22884
   \              0x55F5 0x568A
   \              0x571D 0x57B0
   \              0x5842 0x58D3
   \              0x5964       
   \   000000FE   0x59F3 0x5A82      DC16 23027, 23170, 23311, 23452, 23592, 23731, 23870, 24007, 24143
   \              0x5B0F 0x5B9C
   \              0x5C28 0x5CB3
   \              0x5D3E 0x5DC7
   \              0x5E4F       
   \   00000110   0x5ED7 0x5F5D      DC16 24279, 24413, 24547, 24680, 24811, 24942, 25072, 25201, 25329
   \              0x5FE3 0x6068
   \              0x60EB 0x616E
   \              0x61F0 0x6271
   \              0x62F1       
   \   00000122   0x6370 0x63EE      DC16 25456, 25582, 25708, 25832, 25955, 26077, 26198, 26319, 26438
   \              0x646C 0x64E8
   \              0x6563 0x65DD
   \              0x6656 0x66CF
   \              0x6746       
   \   00000134   0x67BC 0x6832      DC16 26556, 26674, 26790, 26905, 27019, 27133, 27245, 27356, 27466
   \              0x68A6 0x6919
   \              0x698B 0x69FD
   \              0x6A6D 0x6ADC
   \              0x6B4A       
   \   00000146   0x6BB7 0x6C23      DC16 27575, 27683, 27790, 27896, 28001, 28105, 28208, 28310, 28411
   \              0x6C8E 0x6CF8
   \              0x6D61 0x6DC9
   \              0x6E30 0x6E96
   \              0x6EFB       
   \   00000158   0x6F5E 0x6FC1      DC16 28510, 28609, 28706, 28803, 28898, 28992, 29085, 29177, 29268
   \              0x7022 0x7083
   \              0x70E2 0x7140
   \              0x719D 0x71F9
   \              0x7254       
   \   0000016A   0x72AE 0x7307      DC16 29358, 29447, 29534, 29621, 29706, 29791, 29874, 29956, 30037
   \              0x735E 0x73B5
   \              0x740A 0x745F
   \              0x74B2 0x7504
   \              0x7555       
   \   0000017C   0x75A5 0x75F3      DC16 30117, 30195, 30273, 30349, 30424, 30498, 30571, 30643, 30714
   \              0x7641 0x768D
   \              0x76D8 0x7722
   \              0x776B 0x77B3
   \              0x77FA       
   \   0000018E   0x783F 0x7884      DC16 30783, 30852, 30919, 30985, 31050, 31113, 31176, 31237, 31297
   \              0x78C7 0x7909
   \              0x794A 0x7989
   \              0x79C8 0x7A05
   \              0x7A41       
   \   000001A0   0x7A7C 0x7AB6      DC16 31356, 31414, 31470, 31526, 31580, 31633, 31685, 31736, 31785
   \              0x7AEE 0x7B26
   \              0x7B5C 0x7B91
   \              0x7BC5 0x7BF8
   \              0x7C29       
   \   000001B2   0x7C59 0x7C88      DC16 31833, 31880, 31926, 31971, 32014, 32057, 32098, 32137, 32176
   \              0x7CB6 0x7CE3
   \              0x7D0E 0x7D39
   \              0x7D62 0x7D89
   \              0x7DB0       
   \   000001C4   0x7DD5 0x7DFA      DC16 32213, 32250, 32285, 32318, 32351, 32382, 32412, 32441, 32469
   \              0x7E1D 0x7E3E
   \              0x7E5F 0x7E7E
   \              0x7E9C 0x7EB9
   \              0x7ED5       
   \   000001D6   0x7EEF 0x7F09      DC16 32495, 32521, 32545, 32567, 32589, 32609, 32628, 32646, 32663
   \              0x7F21 0x7F37
   \              0x7F4D 0x7F61
   \              0x7F74 0x7F86
   \              0x7F97       
   \   000001E8   0x7FA6 0x7FB4      DC16 32678, 32692, 32705, 32717, 32728, 32737, 32745, 32752, 32757
   \              0x7FC1 0x7FCD
   \              0x7FD8 0x7FE1
   \              0x7FE9 0x7FF0
   \              0x7FF5       
   \   000001FA   0x7FF9 0x7FFD      DC16 32761, 32765, 32766
   \              0x7FFE       
    320          
    321          /*******************************************************************************
    322          * Function Name  : Clarke Transformation
    323          * Description    : This function transforms stator currents qIas and  
    324          *                  qIbs (which are directed along axes each displaced by  
    325          *                  120 degrees) into currents qIalpha and qIbeta in a 
    326          *                  stationary qd reference frame.
    327          *                  qIalpha = qIas
    328          *                  qIbeta = -(2*qIbs+qIas)/sqrt(3)
    329          * Input          : Stat_Curr_a_b
    330          * Output         : Stat_Curr_alfa_beta
    331          * Return         : none.
    332          *******************************************************************************/
    333          

   \                                 In section .text, align 2, keep-with-next
    334          Curr_Components Clarke(Curr_Components Curr_Input)
    335          {
   \                     Clarke:
   \   00000000   0xB401             PUSH     {R0}
   \   00000002   0xB081             SUB      SP,SP,#+4
    336            Curr_Components Curr_Output;
    337            
    338            s32 qIa_divSQRT3_tmp;
    339            s32 qIb_divSQRT3_tmp ;
    340            
    341            s16 qIa_divSQRT3;
    342            s16 qIb_divSQRT3 ;
    343          
    344            // qIalpha = qIas
    345            Curr_Output.qI_Component1= Curr_Input.qI_Component1;
   \   00000004   0xF9BD 0x0004      LDRSH    R0,[SP, #+4]
   \   00000008   0xF8AD 0x0000      STRH     R0,[SP, #+0]
    346          
    347            qIa_divSQRT3_tmp = divSQRT_3 * Curr_Input.qI_Component1; //电流平方根3
    348            qIa_divSQRT3_tmp /=32768;   
    349              
    350            qIb_divSQRT3_tmp = divSQRT_3 * Curr_Input.qI_Component2;
    351            qIb_divSQRT3_tmp /=32768;
    352            
    353            qIa_divSQRT3=((s16)(qIa_divSQRT3_tmp));		
    354            		
    355            qIb_divSQRT3=((s16)(qIb_divSQRT3_tmp));				
    356              
    357            //qIbeta = -(2*qIbs+qIas)/sqrt(3)
    358            Curr_Output.qI_Component2=(-(qIa_divSQRT3)-(qIb_divSQRT3)-(qIb_divSQRT3));
   \   0000000C   0xF644 0x10E6      MOVW     R0,#+18918
   \   00000010   0xF9BD 0x1004      LDRSH    R1,[SP, #+4]
   \   00000014   0x4341             MULS     R1,R1,R0
   \   00000016   0xF9BD 0x2006      LDRSH    R2,[SP, #+6]
   \   0000001A   0x4350             MULS     R0,R0,R2
   \   0000001C   0x138A             ASRS     R2,R1,#+14
   \   0000001E   0xEB01 0x4152      ADD      R1,R1,R2, LSR #+17
   \   00000022   0x13C9             ASRS     R1,R1,#+15
   \   00000024   0x4249             RSBS     R1,R1,#+0
   \   00000026   0x1382             ASRS     R2,R0,#+14
   \   00000028   0xEB00 0x4052      ADD      R0,R0,R2, LSR #+17
   \   0000002C   0x13C0             ASRS     R0,R0,#+15
   \   0000002E   0xEBA1 0x0040      SUB      R0,R1,R0, LSL #+1
   \   00000032   0xF8AD 0x0002      STRH     R0,[SP, #+2]
    359            
    360            return(Curr_Output); 
   \   00000036   0x9800             LDR      R0,[SP, #+0]
   \   00000038   0xB002             ADD      SP,SP,#+8
   \   0000003A   0x4770             BX       LR               ;; return
    361          }
    362          
    363          /*******************************************************************************
    364          * Function Name  : Park Transformation
    365          * Description    : This function transforms stator currents qIalpha and qIbeta,
    366          *                  which belong to a stationary qd reference frame, to a rotor 
    367          *                  flux synchronous reference frame (properly oriented), so as 
    368          *                  to obtain qIq and qIds.
    369          *                  qId=qIalpha_tmp*sin(theta)+qIbeta_tmp*cos(Theta)
    370          *                  qIq=qIalpha_tmp*cos(Theta)-qIbeta_tmp*sin(Theta)                 
    371          * Input          : Stat_Curr_alfa_beta
    372          * Output         : Stat_Curr_q_d.
    373          * Return         : none.
    374          *******************************************************************************/
    375          

   \                                 In section .text, align 2, keep-with-next
    376          Curr_Components Park(Curr_Components Curr_Input, s16 Theta)
    377          {
   \                     Park:
   \   00000000   0xB471             PUSH     {R0,R4-R6}
   \   00000002   0xB081             SUB      SP,SP,#+4
    378            Curr_Components Curr_Output;
    379            s32 qId_tmp_1, qId_tmp_2;
    380            s32 qIq_tmp_1, qIq_tmp_2;     
    381            s16 qId_1, qId_2;  
    382            s16 qIq_1, qIq_2;  
    383            
    384            Vector_Components = Trig_Functions(Theta);
   \   00000004   0xF5A1 0x4000      SUB      R0,R1,#+32768
   \   00000008   0x0400             LSLS     R0,R0,#+16
   \   0000000A   0x0D80             LSRS     R0,R0,#+22
   \   0000000C   0xF410 0x7140      ANDS     R1,R0,#0x300
   \   00000010   0xD012             BEQ.N    ??Park_0
   \   00000012   0xF5B1 0x7F80      CMP      R1,#+256
   \   00000016   0xD006             BEQ.N    ??Park_1
   \   00000018   0xF5B1 0x7F00      CMP      R1,#+512
   \   0000001C   0xD025             BEQ.N    ??Park_2
   \   0000001E   0xF5B1 0x7F40      CMP      R1,#+768
   \   00000022   0xD016             BEQ.N    ??Park_3
   \   00000024   0xE02B             B.N      ??Park_4
   \                     ??Park_1:
   \   00000026   0x.... 0x....      ADR.W    R1,hSin_Cos_Table
   \   0000002A   0xF1C0 0x02FF      RSB      R2,R0,#+255
   \   0000002E   0xB2D2             UXTB     R2,R2
   \   00000030   0xF931 0x2012      LDRSH    R2,[R1, R2, LSL #+1]
   \   00000034   0x4252             RSBS     R2,R2,#+0
   \   00000036   0xE01F             B.N      ??Park_5
   \                     ??Park_0:
   \   00000038   0x.... 0x....      ADR.W    R1,hSin_Cos_Table
   \   0000003C   0xB2C2             UXTB     R2,R0
   \   0000003E   0xF931 0x2012      LDRSH    R2,[R1, R2, LSL #+1]
   \   00000042   0x4252             RSBS     R2,R2,#+0
   \   00000044   0xF1C0 0x00FF      RSB      R0,R0,#+255
   \   00000048   0xB2C0             UXTB     R0,R0
   \   0000004A   0xF931 0x0010      LDRSH    R0,[R1, R0, LSL #+1]
   \   0000004E   0x4243             RSBS     R3,R0,#+0
   \   00000050   0xE015             B.N      ??Park_4
   \                     ??Park_3:
   \   00000052   0x.... 0x....      ADR.W    R1,hSin_Cos_Table
   \   00000056   0xF1C0 0x02FF      RSB      R2,R0,#+255
   \   0000005A   0xB2D2             UXTB     R2,R2
   \   0000005C   0xF931 0x2012      LDRSH    R2,[R1, R2, LSL #+1]
   \   00000060   0xB2C0             UXTB     R0,R0
   \   00000062   0xF931 0x0010      LDRSH    R0,[R1, R0, LSL #+1]
   \   00000066   0x4243             RSBS     R3,R0,#+0
   \   00000068   0xE009             B.N      ??Park_4
   \                     ??Park_2:
   \   0000006A   0x.... 0x....      ADR.W    R1,hSin_Cos_Table
   \   0000006E   0xB2C2             UXTB     R2,R0
   \   00000070   0xF931 0x2012      LDRSH    R2,[R1, R2, LSL #+1]
   \   00000074   0xF1C0 0x00FF      RSB      R0,R0,#+255
   \                     ??Park_5:
   \   00000078   0xB2C0             UXTB     R0,R0
   \   0000007A   0xF931 0x3010      LDRSH    R3,[R1, R0, LSL #+1]
   \                     ??Park_4:
   \   0000007E   0x....             LDR.N    R1,??DataTable4
   \   00000080   0x800B             STRH     R3,[R1, #+0]
   \   00000082   0x804A             STRH     R2,[R1, #+2]
   \   00000084   0xF9B1 0x0000      LDRSH    R0,[R1, #+0]
   \   00000088   0xF9BD 0x2004      LDRSH    R2,[SP, #+4]
   \   0000008C   0xFB00 0xF302      MUL      R3,R0,R2
   \   00000090   0xF9B1 0x1002      LDRSH    R1,[R1, #+2]
   \   00000094   0xF9BD 0x4006      LDRSH    R4,[SP, #+6]
   \   00000098   0xFB01 0xF504      MUL      R5,R1,R4
   \   0000009C   0x139E             ASRS     R6,R3,#+14
   \   0000009E   0xEB03 0x4356      ADD      R3,R3,R6, LSR #+17
   \   000000A2   0x13DB             ASRS     R3,R3,#+15
   \   000000A4   0x13AE             ASRS     R6,R5,#+14
   \   000000A6   0xEB05 0x4556      ADD      R5,R5,R6, LSR #+17
   \   000000AA   0xEBA3 0x33E5      SUB      R3,R3,R5, ASR #+15
   \   000000AE   0xF8AD 0x3000      STRH     R3,[SP, #+0]
    385            
    386            //No overflow guaranteed
    387            qIq_tmp_1 = Curr_Input.qI_Component1 * Vector_Components.hCos;  	
    388            qIq_tmp_1 /= 32768;
    389            
    390            //No overflow guaranteed
    391            qIq_tmp_2 = Curr_Input.qI_Component2 *Vector_Components.hSin;
    392            qIq_tmp_2 /= 32768;
    393           
    394            qIq_1 = ((s16)(qIq_tmp_1));
    395            qIq_2 = ((s16)(qIq_tmp_2));
    396          
    397            //Iq component in Q1.15 Format 
    398            Curr_Output.qI_Component1 = ((qIq_1)-(qIq_2));	
    399            
    400            //No overflow guaranteed
    401            qId_tmp_1 = Curr_Input.qI_Component1 * Vector_Components.hSin;
    402            qId_tmp_1 /= 32768;
    403            
    404            //No overflow guaranteed
    405            qId_tmp_2 = Curr_Input.qI_Component2 * Vector_Components.hCos;
    406            qId_tmp_2 /= 32768;
    407            
    408            qId_1 = (s16)(qId_tmp_1);		
    409            
    410            qId_2 = (s16)(qId_tmp_2);					
    411          
    412             //Id component in Q1.15 Format   
    413            Curr_Output.qI_Component2 = ((qId_1)+(qId_2));  
   \   000000B2   0x4351             MULS     R1,R1,R2
   \   000000B4   0x4360             MULS     R0,R0,R4
   \   000000B6   0x138A             ASRS     R2,R1,#+14
   \   000000B8   0xEB01 0x4152      ADD      R1,R1,R2, LSR #+17
   \   000000BC   0x1382             ASRS     R2,R0,#+14
   \   000000BE   0xEB00 0x4052      ADD      R0,R0,R2, LSR #+17
   \   000000C2   0x13C0             ASRS     R0,R0,#+15
   \   000000C4   0xEB00 0x30E1      ADD      R0,R0,R1, ASR #+15
   \   000000C8   0xF8AD 0x0002      STRH     R0,[SP, #+2]
    414            
    415            return (Curr_Output);
   \   000000CC   0x9800             LDR      R0,[SP, #+0]
   \   000000CE   0xB002             ADD      SP,SP,#+8
   \   000000D0   0xBC70             POP      {R4-R6}
   \   000000D2   0x4770             BX       LR               ;; return
    416            
    417          }
    418          
    419          
    420          /*******************************************************************************
    421          * Function Name  : RevPark_Circle_Limitation
    422          * Description    : Check if
    423          *       Stat_Volt_q_d.qV_Component1^2 + Stat_Volt_q_d.qV_Component2^2 <= 32767^2
    424          *                  Apply limitation if previous condition is not met,
    425          *                  by keeping a constant ratio 
    426          *                  Stat_Volt_q_d.qV_Component1/Stat_Volt_q_d.qV_Component2
    427          * Input          : None
    428          * Output         : None
    429          * Return         : None
    430          *******************************************************************************/
    431          

   \                                 In section .text, align 2, keep-with-next
    432          void RevPark_Circle_Limitation(void)
    433          {
    434          s32 temp;
    435                       
    436          temp = Stat_Volt_q_d.qV_Component1 * Stat_Volt_q_d.qV_Component1 
    437                       + Stat_Volt_q_d.qV_Component2 * Stat_Volt_q_d.qV_Component2;  // min value 0, max value 2*32767*32767
   \                     RevPark_Circle_Limitation:
   \   00000000   0x....             LDR.N    R0,??DataTable4_1
   \   00000002   0xF9B0 0x1002      LDRSH    R1,[R0, #+2]
   \   00000006   0xF9B0 0x2000      LDRSH    R2,[R0, #+0]
   \   0000000A   0xFB01 0xF301      MUL      R3,R1,R1
   \   0000000E   0xFB02 0x3302      MLA      R3,R2,R2,R3
    438                        
    439          if ( temp > (u32)(( MAX_MODULE * MAX_MODULE) ) ) // (Vd^2+Vq^2) > MAX_MODULE^2 ?
   \   00000012   0x.... 0x....      LDR.W    R12,??DataTable4_2  ;; 0x3d759622
   \   00000016   0x4563             CMP      R3,R12
   \   00000018   0xD313             BCC.N    ??RevPark_Circle_Limitation_0
    440             {
    441             u16 index;
    442                        
    443             temp /= (u32)(512*32768);  // min value START_INDEX, max value 127
    444             temp -= START_INDEX ;   // min value 0, max value 127 - START_INDEX
    445             index = circle_limit_table[(u8)temp];
   \   0000001A   0x0E1B             LSRS     R3,R3,#+24
   \   0000001C   0x3B3D             SUBS     R3,R3,#+61
   \   0000001E   0xB2DB             UXTB     R3,R3
   \   00000020   0x.... 0x....      ADR.W    R12,circle_limit_table
   \   00000024   0xF83C 0x3013      LDRH     R3,[R12, R3, LSL #+1]
    446                        
    447             temp = (s16)Stat_Volt_q_d.qV_Component1 * (u16)(index); 
    448             Stat_Volt_q_d.qV_Component1 = (s16)(temp/32768);  
   \   00000028   0x435A             MULS     R2,R2,R3
   \   0000002A   0xEA4F 0x3CA2      ASR      R12,R2,#+14
   \   0000002E   0xEB02 0x425C      ADD      R2,R2,R12, LSR #+17
   \   00000032   0x13D2             ASRS     R2,R2,#+15
   \   00000034   0x8002             STRH     R2,[R0, #+0]
    449                        
    450             temp = (s16)Stat_Volt_q_d.qV_Component2 * (u16)(index); 
    451             Stat_Volt_q_d.qV_Component2 = (s16)(temp/32768);  
   \   00000036   0x4359             MULS     R1,R1,R3
   \   00000038   0x138A             ASRS     R2,R1,#+14
   \   0000003A   0xEB01 0x4152      ADD      R1,R1,R2, LSR #+17
   \   0000003E   0x13C9             ASRS     R1,R1,#+15
   \   00000040   0x8041             STRH     R1,[R0, #+2]
    452             }
    453          
    454          } 
   \                     ??RevPark_Circle_Limitation_0:
   \   00000042   0x4770             BX       LR               ;; return
    455          
    456          /*******************************************************************************
    457          * Function Name  : Rev_Park Transformation
    458          * Description    : This function transforms stator voltage qVq and qVd, that 
    459          *                  belong to a rotor flux synchronous rotating frame, to a 
    460          *                 stationary reference frame, so as to obtain qValpha and qVbeta
    461          *                  qValfa=qVq*Cos(theta)+qVd*Sin(theta)
    462          *                  qVbeta=-qVq*Sin(theta)+qVd*Cos(theta)                  
    463          * Input          : Stat_Volt_q_d.
    464          * Output         : Stat_Volt_a_b
    465          * Return         : none.
    466          *******************************************************************************/
    467          

   \                                 In section .text, align 2, keep-with-next
    468          Volt_Components Rev_Park(Volt_Components Volt_Input)
    469          { 	
   \                     Rev_Park:
   \   00000000   0xB471             PUSH     {R0,R4-R6}
   \   00000002   0xB081             SUB      SP,SP,#+4
    470            s32 qValpha_tmp1,qValpha_tmp2,qVbeta_tmp1,qVbeta_tmp2;
    471            s16 qValpha_1,qValpha_2,qVbeta_1,qVbeta_2;
    472            Volt_Components Volt_Output;
    473             
    474            //No overflow guaranteed
    475            qValpha_tmp1 = Volt_Input.qV_Component1 * Vector_Components.hCos;
    476            qValpha_tmp1 /= 32768;
    477            
    478            qValpha_tmp2 = Volt_Input.qV_Component2 * Vector_Components.hSin;
    479            qValpha_tmp2 /= 32768;
    480          		
    481            qValpha_1 = (s16)(qValpha_tmp1);		
    482            qValpha_2 = (s16)(qValpha_tmp2);			
    483          
    484            Volt_Output.qV_Component1 = ((qValpha_1)+(qValpha_2));
   \   00000004   0x....             LDR.N    R1,??DataTable4
   \   00000006   0xF9B1 0x2000      LDRSH    R2,[R1, #+0]
   \   0000000A   0xF9BD 0x0004      LDRSH    R0,[SP, #+4]
   \   0000000E   0xFB02 0xF300      MUL      R3,R2,R0
   \   00000012   0xF9B1 0x1002      LDRSH    R1,[R1, #+2]
   \   00000016   0xF9BD 0x4006      LDRSH    R4,[SP, #+6]
   \   0000001A   0xFB01 0xF504      MUL      R5,R1,R4
   \   0000001E   0x139E             ASRS     R6,R3,#+14
   \   00000020   0xEB03 0x4356      ADD      R3,R3,R6, LSR #+17
   \   00000024   0x13AE             ASRS     R6,R5,#+14
   \   00000026   0xEB05 0x4556      ADD      R5,R5,R6, LSR #+17
   \   0000002A   0x13ED             ASRS     R5,R5,#+15
   \   0000002C   0xEB05 0x33E3      ADD      R3,R5,R3, ASR #+15
   \   00000030   0xF8AD 0x3000      STRH     R3,[SP, #+0]
    485           
    486            
    487            qVbeta_tmp1 = Volt_Input.qV_Component1 * Vector_Components.hSin;
    488            qVbeta_tmp1 /= 32768;
    489            
    490            qVbeta_tmp2 = Volt_Input.qV_Component2 * Vector_Components.hCos;
    491            qVbeta_tmp2 /= 32768;
    492          
    493            qVbeta_1 = (s16)(qVbeta_tmp1);				
    494            qVbeta_2 = (s16)(qVbeta_tmp2);
    495             				
    496            Volt_Output.qV_Component2 = -(qVbeta_1)+(qVbeta_2);
   \   00000034   0x4362             MULS     R2,R2,R4
   \   00000036   0x4348             MULS     R0,R0,R1
   \   00000038   0x1391             ASRS     R1,R2,#+14
   \   0000003A   0xEB02 0x4151      ADD      R1,R2,R1, LSR #+17
   \   0000003E   0x13C9             ASRS     R1,R1,#+15
   \   00000040   0x1382             ASRS     R2,R0,#+14
   \   00000042   0xEB00 0x4052      ADD      R0,R0,R2, LSR #+17
   \   00000046   0xEBA1 0x30E0      SUB      R0,R1,R0, ASR #+15
   \   0000004A   0xF8AD 0x0002      STRH     R0,[SP, #+2]
    497           
    498            return(Volt_Output);
   \   0000004E   0x9800             LDR      R0,[SP, #+0]
   \   00000050   0xB002             ADD      SP,SP,#+8
   \   00000052   0xBC70             POP      {R4-R6}
   \   00000054   0x4770             BX       LR               ;; return
    499          }
    500          /*******************************************************************************
    501          * Function Name  : Trig_Functions 
    502          * Description    : This function returns Cosine and Sine functions of the input 
    503          *                  angle
    504          * Input          : angle in s16 format
    505          * Output         : Cosine and Sine in s16 format
    506          * Return         : none.
    507          *******************************************************************************/

   \                                 In section .text, align 2, keep-with-next
    508          Trig_Components Trig_Functions(s16 hAngle)
    509          {
   \                     Trig_Functions:
   \   00000000   0xB081             SUB      SP,SP,#+4
    510            u16 hindex;
    511            Trig_Components Local_Components;
    512            
    513            /* 10 bit index computation  */  
    514            hindex = (u16)(hAngle + 32768);  
    515            hindex /= 64;      
   \   00000002   0xF5A0 0x4000      SUB      R0,R0,#+32768
   \   00000006   0x0400             LSLS     R0,R0,#+16
   \   00000008   0x0D81             LSRS     R1,R0,#+22
    516            
    517            switch (hindex & SIN_MASK) 
   \   0000000A   0xF411 0x7040      ANDS     R0,R1,#0x300
   \   0000000E   0xD023             BEQ.N    ??Trig_Functions_0
   \   00000010   0xF5B0 0x7F80      CMP      R0,#+256
   \   00000014   0xD02F             BEQ.N    ??Trig_Functions_1
   \   00000016   0xF5B0 0x7F00      CMP      R0,#+512
   \   0000001A   0xD005             BEQ.N    ??Trig_Functions_2
   \   0000001C   0xF5B0 0x7F40      CMP      R0,#+768
   \   00000020   0xD00C             BEQ.N    ??Trig_Functions_3
   \   00000022   0x9800             LDR      R0,[SP, #+0]
   \   00000024   0xB001             ADD      SP,SP,#+4
   \   00000026   0x4770             BX       LR
    518            {
    519            case U0_90:
    520              Local_Components.hSin = hSin_Cos_Table[(u8)(hindex)];
   \                     ??Trig_Functions_2:
   \   00000028   0x.... 0x....      ADR.W    R0,hSin_Cos_Table
   \   0000002C   0xB2CA             UXTB     R2,R1
   \   0000002E   0xF830 0x2012      LDRH     R2,[R0, R2, LSL #+1]
   \   00000032   0xF8AD 0x2002      STRH     R2,[SP, #+2]
    521              Local_Components.hCos = hSin_Cos_Table[(u8)(0xFF-(u8)(hindex))];
   \   00000036   0xF1C1 0x01FF      RSB      R1,R1,#+255
   \   0000003A   0xE026             B.N      ??Trig_Functions_4
    522              break;
    523            
    524            case U90_180:  
    525               Local_Components.hSin = hSin_Cos_Table[(u8)(0xFF-(u8)(hindex))];
   \                     ??Trig_Functions_3:
   \   0000003C   0x.... 0x....      ADR.W    R0,hSin_Cos_Table
   \   00000040   0xF1C1 0x02FF      RSB      R2,R1,#+255
   \   00000044   0xB2D2             UXTB     R2,R2
   \   00000046   0xF830 0x2012      LDRH     R2,[R0, R2, LSL #+1]
   \   0000004A   0xF8AD 0x2002      STRH     R2,[SP, #+2]
    526               Local_Components.hCos = -hSin_Cos_Table[(u8)(hindex)];
   \   0000004E   0xB2C9             UXTB     R1,R1
   \   00000050   0xF930 0x0011      LDRSH    R0,[R0, R1, LSL #+1]
   \   00000054   0x4240             RSBS     R0,R0,#+0
   \   00000056   0xE01B             B.N      ??Trig_Functions_5
    527              break;
    528            
    529            case U180_270:
    530               Local_Components.hSin = -hSin_Cos_Table[(u8)(hindex)];
   \                     ??Trig_Functions_0:
   \   00000058   0x.... 0x....      ADR.W    R0,hSin_Cos_Table
   \   0000005C   0xB2CA             UXTB     R2,R1
   \   0000005E   0xF930 0x2012      LDRSH    R2,[R0, R2, LSL #+1]
   \   00000062   0x4252             RSBS     R2,R2,#+0
   \   00000064   0xF8AD 0x2002      STRH     R2,[SP, #+2]
    531               Local_Components.hCos = -hSin_Cos_Table[(u8)(0xFF-(u8)(hindex))];
   \   00000068   0xF1C1 0x01FF      RSB      R1,R1,#+255
   \   0000006C   0xB2C9             UXTB     R1,R1
   \   0000006E   0xF930 0x0011      LDRSH    R0,[R0, R1, LSL #+1]
   \   00000072   0x4240             RSBS     R0,R0,#+0
   \   00000074   0xE00C             B.N      ??Trig_Functions_5
    532              break;
    533            
    534            case U270_360:
    535               Local_Components.hSin =  -hSin_Cos_Table[(u8)(0xFF-(u8)(hindex))];
   \                     ??Trig_Functions_1:
   \   00000076   0x.... 0x....      ADR.W    R0,hSin_Cos_Table
   \   0000007A   0xF1C1 0x02FF      RSB      R2,R1,#+255
   \   0000007E   0xB2D2             UXTB     R2,R2
   \   00000080   0xF930 0x2012      LDRSH    R2,[R0, R2, LSL #+1]
   \   00000084   0x4252             RSBS     R2,R2,#+0
   \   00000086   0xF8AD 0x2002      STRH     R2,[SP, #+2]
    536               Local_Components.hCos =  hSin_Cos_Table[(u8)(hindex)]; 
   \                     ??Trig_Functions_4:
   \   0000008A   0xB2C9             UXTB     R1,R1
   \   0000008C   0xF930 0x0011      LDRSH    R0,[R0, R1, LSL #+1]
   \                     ??Trig_Functions_5:
   \   00000090   0xF8AD 0x0000      STRH     R0,[SP, #+0]
    537              break;
    538            default:
    539              break;
    540            }
    541            return (Local_Components);
   \   00000094   0x9800             LDR      R0,[SP, #+0]
   \   00000096   0xB001             ADD      SP,SP,#+4
   \   00000098   0x4770             BX       LR               ;; return
    542          }

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4:
   \   00000000   0x........         DC32     Vector_Components

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_1:
   \   00000000   0x........         DC32     Stat_Volt_q_d

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable4_2:
   \   00000000   0x3D759622         DC32     0x3d759622
    543          /******************* (C) COPYRIGHT 2008 STMicroelectronics *****END OF FILE****/

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
        8  Clarke
       20  Park
        0  RevPark_Circle_Limitation
       20  Rev_Park
        4  Trig_Functions


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable4
       4  ??DataTable4_1
       4  ??DataTable4_2
      60  Clarke
     212  Park
      68  RevPark_Circle_Limitation
      86  Rev_Park
     154  Trig_Functions
       4  Vector_Components
     136  circle_limit_table
     512  hSin_Cos_Table

 
     4 bytes in section .bss
 1 240 bytes in section .text
 
 1 240 bytes of CODE memory
     4 bytes of DATA memory

Errors: none
Warnings: 1
